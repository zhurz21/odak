
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The fundamental library for scientific computing in optical and visual perception sciences.">
      
      
        <meta name="author" content="Kaan Akşit">
      
      
        <link rel="canonical" href="https://kunguz.github.io/odak/notes/optimizing_holograms_using_odak/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.3">
    
    
      
        <title>Optimizing holograms using Odak - Odak</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.62128196.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9204c3b2.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>function __md_scope(e,t,_){return new URL(_||(t===localStorage?"../..":"../.."),location).pathname+"."+e}function __md_get(e,t=localStorage,_){return JSON.parse(t.getItem(__md_scope(e,t,_)))}function __md_set(e,t,_=localStorage,o){try{_.setItem(__md_scope(e,_,o),JSON.stringify(t))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#optimizing-holograms-using-odak" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
For updates follow 
<a href="https://twitter.com/kaanaksit" style="color:#1da1f2;">
<strong>@kaanaksit</strong> 
</a>
on
<a href="https://twitter.com/kaanaksit" style="color:#1da1f2;">
<span class="twemoji twitter"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </span>
</a>
<strong>
Twitter
</strong>

          </div>
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Odak" class="md-header__button md-logo" aria-label="Odak" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Odak
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Optimizing holograms using Odak
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kunguz/odak/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kunguz/odak
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Odak" class="md-nav__button md-logo" aria-label="Odak" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Odak
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kunguz/odak/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kunguz/odak
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cgh/" class="md-nav__link">
        Computer-Generated Holography
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../toolkit/" class="md-nav__link">
        General toolkit
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../perception/" class="md-nav__link">
        Visual perception
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    Preparation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stochastic-gradient-descent-approach" class="md-nav__link">
    Stochastic Gradient Descent approach
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See also
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/kunguz/odak/edit/master/docs/notes/optimizing_holograms_using_odak.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="optimizing-holograms-using-odak">Optimizing holograms using Odak<a class="headerlink" href="#optimizing-holograms-using-odak" title="Permanent link">&para;</a></h1>
<p>This engineering note will give you an idea about how to optimize phase-only holograms using Odak.
We consult the beginners in this matter to <code>Goodman's Introduction to Fourier Optics</code> (ISBN-13:  978-0974707723) and <code>Principles of optics: electromagnetic theory of propagation, interference and diffraction of light</code> from Max Born and Emil Wolf (ISBN 0-08-26482-4).
Note that the creators of this documentation are from the <code>Computational Displays</code> domain.
However, the provided submodules can potentially aid other lines of research as well, such as <code>Computational Imaging</code> or <code>Computational Microscopy</code>.</p>
<p>The optimization that is referred to in this document is the one that generates a phase-only hologram that can reconstruct a target image.
There are multiple ways in the literature to optimize a phase-only hologram for a single plane, and these include:</p>
<p>Gerchberg-Saxton and Yang-Yu algorithms:
- Yang, G. Z., Dong, B. Z., Gu, B. Y., Zhuang, J. Y., &amp; Ersoy, O. K. (1994). Gerchberg–Saxton and Yang–Gu algorithms for phase retrieval in a nonunitary transform system: a comparison. Applied optics, 33(2), 209-218.</p>
<p>Stochastic Gradient Descent based optimization:
- Chen, Y., Chi, Y., Fan, J., &amp; Ma, C. (2019). Gradient descent with random initialization: Fast global convergence for nonconvex phase retrieval. Mathematical Programming, 176(1), 5-37.</p>
<p>Odak provides functions to optimize phase-only holograms using <code>Gerchberg-Saxton</code> algorithm or the <code>Stochastic Gradient Descent</code> based approach.
The relevant functions here are <code>odak.learn.wave.stochastic_gradient_descent</code> and <code>odak.learn.wave.gerchberg_saxton</code>.
We will review both of these definitions in this document.
But first, let's get prepared.</p>
<h2 id="preparation">Preparation<a class="headerlink" href="#preparation" title="Permanent link">&para;</a></h2>
<p>We first start with imports, here is all you need:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odak.learn.wave</span> <span class="kn">import</span> <span class="n">stochastic_gradient_descent</span><span class="p">,</span> <span class="n">calculate_amplitude</span><span class="p">,</span> <span class="n">calculate_phase</span>
<span class="kn">import</span> <span class="nn">torch</span>
</code></pre></div>
<p>We will also be needing some variables that defines the wavelength of light that we work with:</p>
<div class="highlight"><pre><span></span><code><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">0.000000532</span>
</code></pre></div>
<p>Pixel pitch and resolution of the phase-only hologram or a phase-only spatial light modulator that we are simulating:</p>
<div class="highlight"><pre><span></span><code><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.0000064</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1920</span><span class="p">]</span>
</code></pre></div>
<p>Define the distance that the light will travel from optimized hologram.</p>
<div class="highlight"><pre><span></span><code><span class="n">distance</span> <span class="o">=</span> <span class="mf">0.15</span>
</code></pre></div>
<p>We have to set a target image. 
You can either load a sample image here or paint a white rectangle on a white background like in this example.</p>
<div class="highlight"><pre><span></span><code><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">resolution</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">resolution</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">target</span><span class="p">[</span><span class="mi">500</span><span class="p">:</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">:</span><span class="mi">450</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
</code></pre></div>
<p>Surely, we also have to set the number of iterations and learning rate for our optimizations.
If you want the GPU support, you also have to set the <code>cuda</code> as <code>True</code>.
Propagation type has to be defined as well.
In this example, we will use transfer function Fresnel approach.
For more on propagation types, curious readers can consult 
<code>Computational Fourier</code> Optics <code>David Vuelz</code> (ISBN13:9780819482044).</p>
<div class="highlight"><pre><span></span><code><span class="n">iteration_number</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">propagation_type</span> <span class="o">=</span> <span class="s1">&#39;TR Fresnel&#39;</span>
</code></pre></div>
<p>This step concludes our preparations.
Let's dive into optimizing our phase-only holograms.
Depending on your choice, you can either optimize using <code>Gerchberg-Saxton</code> approach or the <code>Stochastic Gradient Descent</code> approach.
This document will only show you <code>Stochastic Gradient Descent</code> approach as it is the state of art.
However, optimizing a phase-only hologram is as importing:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odak.learn.wave</span> <span class="kn">import</span> <span class="n">gerchberg_saxton</span>
</code></pre></div>
<p>and almost as easy as replacing <code>stochastic_gradient_descent</code> with <code>gerchberg_saxton</code> in the upcoming described hologram routine.
For greater details, consult to <a href="../../odak/wave/gerchberg_saxton/">documentation of odak.learn.wave.gerchberg_saxton</a>.</p>
<h2 id="stochastic-gradient-descent-approach">Stochastic Gradient Descent approach<a class="headerlink" href="#stochastic-gradient-descent-approach" title="Permanent link">&para;</a></h2>
<p>We have prepared a function for you to avoid compiling a differentiable hologram optimizer from scratch.</p>
<div class="highlight"><pre><span></span><code><span class="n">hologram</span><span class="p">,</span> <span class="n">reconstructed</span> <span class="o">=</span> <span class="n">stochastic_gradient_descent</span><span class="p">(</span>
        <span class="n">target</span><span class="p">,</span>
        <span class="n">wavelength</span><span class="p">,</span>
        <span class="n">distance</span><span class="p">,</span>
        <span class="n">dx</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">,</span>
        <span class="s1">&#39;TR Fresnel&#39;</span><span class="p">,</span>
        <span class="n">iteration_number</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
        <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span>
    <span class="p">)</span>
</code></pre></div>
<pre><code>Iteration: 99 loss:0.0003
</code></pre>
<p>Congratulations! You have just optimized a phase-only hologram that reconstruct your target image at the target depth.</p>
<p>Surely, you want to see what kind of image is being reconstructed with this newly optimized hologram.
You can save the outcome to an image file easily.
Odak provides tools to save and load images.
First, you have to import:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odak.learn.tools</span> <span class="kn">import</span> <span class="n">save_image</span><span class="p">,</span><span class="n">load_image</span>
</code></pre></div>
<p>As you can recall, we have created a target image earlier that is normalized between zero and one. 
The same is true for our result, <code>reconstructed</code>.
Therefore, we have to save it correctly by taking that into account.
Note that <code>reconstructed</code> is the complex field generated by our optimized <code>hologram</code> variable.
So, we need to save the <code>reconstructed</code> intensity as humans and cameras capture intensity but not a complex field with phase and amplitude.</p>
<div class="highlight"><pre><span></span><code><span class="n">reconstructed_intensity</span> <span class="o">=</span> <span class="n">calculate_amplitude</span><span class="p">(</span><span class="n">reconstructed</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">save_image</span><span class="p">(</span><span class="s1">&#39;reconstructed_image.png&#39;</span><span class="p">,</span><span class="n">reconstructed_intensity</span><span class="p">,</span><span class="n">cmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">cmax</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
</code></pre></div>
<pre><code>True
</code></pre>
<p>To save our hologram as an image so that we can load it to a spatial light modulator, we have to normalize it between zero and 255 (dynamic range of a typical image on a computer).</p>
<p>P.S. Depending on your SLM's calibration and dynamic range things may vary.</p>
<div class="highlight"><pre><span></span><code><span class="n">slm_range</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span>
<span class="n">dynamic_range</span> <span class="o">=</span> <span class="mi">255</span>
<span class="n">phase_hologram</span> <span class="o">=</span> <span class="n">calculate_phase</span><span class="p">(</span><span class="n">hologram</span><span class="p">)</span>
<span class="n">phase_only_hologram</span> <span class="o">=</span> <span class="p">(</span><span class="n">phase_hologram</span><span class="o">%</span><span class="n">slm_range</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">slm_range</span><span class="p">)</span><span class="o">*</span><span class="n">dynamic_range</span>
</code></pre></div>
<p>It is now time for saving our hologram:</p>
<div class="highlight"><pre><span></span><code><span class="n">save_image</span><span class="p">(</span><span class="s1">&#39;phase_only_hologram.png&#39;</span><span class="p">,</span><span class="n">phase_only_hologram</span><span class="p">)</span>
</code></pre></div>
<pre><code>True
</code></pre>
<p>In some cases, you may want to add a grating term to your hologram as you will display it on a spatial light modulator.
There are various reasons for that, but the most obvious is getting rid of zeroth-order reflections that are not modulated by your hologram.
In case you need it is as simple as below:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odak.learn.wave</span> <span class="kn">import</span> <span class="n">linear_grating</span>
<span class="n">grating</span> <span class="o">=</span> <span class="n">linear_grating</span><span class="p">(</span><span class="n">resolution</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">resolution</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">phase_hologram</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="n">phase_only_hologram_w_grating</span> <span class="o">=</span> <span class="n">phase_hologram</span><span class="o">+</span><span class="n">calculate_phase</span><span class="p">(</span><span class="n">grating</span><span class="p">)</span>
</code></pre></div>
<p>And let's save what we got from this step:</p>
<div class="highlight"><pre><span></span><code><span class="n">phase_only_hologram_w_grating</span> <span class="o">=</span> <span class="p">(</span><span class="n">phase_only_hologram_w_grating</span><span class="o">%</span><span class="n">slm_range</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">slm_range</span><span class="p">)</span><span class="o">*</span><span class="n">dynamic_range</span>
<span class="n">save_image</span><span class="p">(</span><span class="s1">&#39;phase_only_hologram_w_grating.png&#39;</span><span class="p">,</span><span class="n">phase_only_hologram_w_grating</span><span class="p">)</span>
</code></pre></div>
<pre><code>True
</code></pre>
<h2 id="see-also">See also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<p>For more engineering notes, follow:</p>
<ul>
<li><a href="../../cgh/"><code>Computer Generated-Holography</code></a></li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/kaanaksit" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.01824240.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.e0abf5b0.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>